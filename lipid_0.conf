# NAMD Config file - autogenerated by NAMDgui plugin
# Author: Jan Saam,  saam@charite.de
#
#  NPT con campo esterno di 0.5 volt/nm
#

# input
coordinates             lipid.pdb
structure               lipid.psf 
parameters              lipid.prm
paratypecharmm          on
###############################################
#    Restart job
###############################################
proc get_first_ts { xscfile } {
  set fd [open $xscfile r ]
  gets    $fd
  gets    $fd
  gets    $fd line
  set ts [lindex $line 0]
  close $fd
  return $ts
}
set firstts [get_first_ts lipid_0.xsc]
###
bincoordinates          lipid_0.coor
binvelocities           lipid_0.vel
extendedSystem          lipid_0.xsc
##

set temperature         310
#temperature             $temperature
####
firsttimestep           $firstts
###################################################
#     No Restart job
###################################################
#bincoordinates          popepops-eqNPT-1.coor
#extendedSystem          popepops-eqNPT-1.xsc
#binvelocities		popepops-eqNPT-1.vel 
#set temperature         310
#temperature             $temperature
###################################################
#
# output
set output              lipid_1
outputname              $output
dcdfile                 ${output}.dcd
xstFile                 ${output}.xst
dcdfreq                 1000
xstFreq                 1000

# electric field
eFieldOn		off  
#eField			0 0 1.153
#
#
binaryoutput            yes
binaryrestart           yes
outputEnergies          100
restartfreq             1000000
restartname             lipid_res_0
restartsave             yes


# mobile atom selection:
# waters
fixedAtoms              off
#fixedAtomsFile     :wq    one.fix       
#fixedAtomsCol           B

# Force field parameters
exclude                 scaled1-4
1-4scaling              1
cutoff                  15.0
switching               on
switchdist              14.0
pairlistdist            17.0
margin			6.5

# Multiple timestepping
timestep                1.0
rigidBonds              all      ;# needed for 2fs steps
stepspercycle           20
nonbondedFreq           2
fullElectFrequency      4

# Periodic Boundary Conditions
#cellBasisVector1    64.0   0.   0.
#cellBasisVector2     0.   64.0  0.
#cellBasisVector3     0.    0   79.0
#cellOrigin          47.54 46.52 33.15

wrapAll             on  
wrapWater           on
useSettle           off

# PME (for full-system periodic electrostatics)
PME                 on
PMEGridSizeX       120
PMEGridSizeY       120
PMEGridSizeZ       120

# Constant Pressure Control (variable volume)
useGroupPressure      yes ;# needed for rigidBonds
useFlexibleCell       yes
useConstantArea       off

langevinPiston        on
langevinPistonTarget  1.01325 ;#  in bar -> 1 atm
langevinPistonPeriod  200.
langevinPistonDecay   50.
langevinPistonTemp    $temperature


# Constant Temperature Control
#langevin            on    ;# do langevin dynamics
#langevinDamping     5     ;# damping coefficient (gamma) of 5/ps
#langevinTemp        $temperature
#langevinHydrogen    off    ;# don't couple langevin bath to hydrogens
#
#temperature             $temperature;  # initial temperature


# Scripting

minimization off
#minimize 200  

#run 20000000  ;# 20ns (timestep 1fs)
run 50000  ;# 50ps (timestep 1fs)
#run 2000000  ;# 2000ps (timestep 1fs)
